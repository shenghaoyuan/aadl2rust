RustModule {
    name: "toy_example_nowrapper",
    docs: [
        "// Auto-generated from AADL package: Toy_Example_NoWrapper",
    ],
    items: [
        TypeAlias(
            TypeAlias {
                name: "POS_Internal_Type",
                target: Named(
                    "i32",
                ),
                vis: Public,
                docs: [
                    "// AADL Data Type: POS_Internal_Type",
                ],
            },
        ),
        TypeAlias(
            TypeAlias {
                name: "POS",
                target: Named(
                    "()",
                ),
                vis: Public,
                docs: [
                    "// AADL Data Type: POS",
                ],
            },
        ),
        TypeAlias(
            TypeAlias {
                name: "POSShared",
                target: Generic(
                    "Arc",
                    [
                        Generic(
                            "Mutex",
                            [
                                Named(
                                    "POS_Internal_Type",
                                ),
                            ],
                        ),
                    ],
                ),
                vis: Public,
                docs: [
                    "// Shared data type for POS",
                    "// Auto-generated from AADL data implementation",
                ],
            },
        ),
        Mod(
            RustModule {
                name: "update",
                docs: [
                    "// Auto-generated from AADL subprogram: Update",
                    "// C binding to: user_update",
                    "// source_files: toy.c",
                ],
                items: [
                    Use(
                        UseStatement {
                            path: [
                                "super",
                            ],
                            kind: Nested(
                                [
                                    "user_update",
                                    "POS_Internal_Type",
                                ],
                            ),
                        },
                    ),
                    Function(
                        FunctionDef {
                            name: "call",
                            params: [
                                Param {
                                    name: "pos_ref",
                                    ty: Reference(
                                        Named(
                                            "POS_Internal_Type",
                                        ),
                                        true,
                                        true,
                                    ),
                                },
                            ],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Unsafe(
                                            Block {
                                                stmts: [
                                                    Expr(
                                                        Call(
                                                            Path(
                                                                [
                                                                    "user_update",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [
                                                                Ident(
                                                                    "pos_ref",
                                                                ),
                                                            ],
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: Public,
                            docs: [
                                "// Call C function user_update with data access reference",
                                "// Generated for requires data access feature",
                                "// Note: Rust compiler will handle the reference to pointer conversion",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                attrs: [],
                vis: Public,
            },
        ),
        Mod(
            RustModule {
                name: "read_pos",
                docs: [
                    "// Auto-generated from AADL subprogram: Read_POS",
                    "// C binding to: user_read",
                    "// source_files: toy.c",
                ],
                items: [
                    Use(
                        UseStatement {
                            path: [
                                "super",
                            ],
                            kind: Nested(
                                [
                                    "user_read",
                                    "POS_Internal_Type",
                                ],
                            ),
                        },
                    ),
                    Function(
                        FunctionDef {
                            name: "call",
                            params: [
                                Param {
                                    name: "pos_ref",
                                    ty: Reference(
                                        Named(
                                            "POS_Internal_Type",
                                        ),
                                        true,
                                        true,
                                    ),
                                },
                            ],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Unsafe(
                                            Block {
                                                stmts: [
                                                    Expr(
                                                        Call(
                                                            Path(
                                                                [
                                                                    "user_read",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [
                                                                Ident(
                                                                    "pos_ref",
                                                                ),
                                                            ],
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: Public,
                            docs: [
                                "// Call C function user_read with data access reference",
                                "// Generated for requires data access feature",
                                "// Note: Rust compiler will handle the reference to pointer conversion",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                attrs: [],
                vis: Public,
            },
        ),
        Mod(
            RustModule {
                name: "gnc_job",
                docs: [
                    "// Auto-generated from AADL subprogram: GNC_Job",
                    "// C binding to: user_gnc_job",
                    "// source_files: toy.c",
                ],
                items: [
                    Use(
                        UseStatement {
                            path: [
                                "super",
                            ],
                            kind: Nested(
                                [
                                    "user_gnc_job",
                                ],
                            ),
                        },
                    ),
                    Function(
                        FunctionDef {
                            name: "execute",
                            params: [],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Unsafe(
                                            Block {
                                                stmts: [
                                                    Expr(
                                                        Call(
                                                            Path(
                                                                [
                                                                    "user_gnc_job",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [],
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: Public,
                            docs: [
                                "// Direct execution wrapper for C function user_gnc_job",
                                "// This component has no communication ports",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                attrs: [],
                vis: Public,
            },
        ),
        Mod(
            RustModule {
                name: "tmtc_job",
                docs: [
                    "// Auto-generated from AADL subprogram: TMTC_Job",
                    "// C binding to: user_tmtc_job",
                    "// source_files: toy.c",
                ],
                items: [
                    Use(
                        UseStatement {
                            path: [
                                "super",
                            ],
                            kind: Nested(
                                [
                                    "user_tmtc_job",
                                ],
                            ),
                        },
                    ),
                    Function(
                        FunctionDef {
                            name: "execute",
                            params: [],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Unsafe(
                                            Block {
                                                stmts: [
                                                    Expr(
                                                        Call(
                                                            Path(
                                                                [
                                                                    "user_tmtc_job",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [],
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: Public,
                            docs: [
                                "// Direct execution wrapper for C function user_tmtc_job",
                                "// This component has no communication ports",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                attrs: [],
                vis: Public,
            },
        ),
        Mod(
            RustModule {
                name: "gnc_identity",
                docs: [
                    "// Auto-generated from AADL subprogram: GNC_Identity",
                    "// C binding to: user_gnc_identity",
                    "// source_files: toy.c",
                ],
                items: [
                    Use(
                        UseStatement {
                            path: [
                                "super",
                            ],
                            kind: Nested(
                                [
                                    "user_gnc_identity",
                                ],
                            ),
                        },
                    ),
                    Function(
                        FunctionDef {
                            name: "execute",
                            params: [],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Unsafe(
                                            Block {
                                                stmts: [
                                                    Expr(
                                                        Call(
                                                            Path(
                                                                [
                                                                    "user_gnc_identity",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [],
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: Public,
                            docs: [
                                "// Direct execution wrapper for C function user_gnc_identity",
                                "// This component has no communication ports",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                attrs: [],
                vis: Public,
            },
        ),
        Mod(
            RustModule {
                name: "tmtc_identity",
                docs: [
                    "// Auto-generated from AADL subprogram: TMTC_Identity",
                    "// C binding to: user_tmtc_identity",
                    "// source_files: toy.c",
                ],
                items: [
                    Use(
                        UseStatement {
                            path: [
                                "super",
                            ],
                            kind: Nested(
                                [
                                    "user_tmtc_identity",
                                ],
                            ),
                        },
                    ),
                    Function(
                        FunctionDef {
                            name: "execute",
                            params: [],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Unsafe(
                                            Block {
                                                stmts: [
                                                    Expr(
                                                        Call(
                                                            Path(
                                                                [
                                                                    "user_tmtc_identity",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [],
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: Public,
                            docs: [
                                "// Direct execution wrapper for C function user_tmtc_identity",
                                "// This component has no communication ports",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                attrs: [],
                vis: Public,
            },
        ),
        Struct(
            StructDef {
                name: "gnc_threadThread",
                fields: [
                    Field {
                        name: "gnc_pos",
                        ty: Named(
                            "POSShared",
                        ),
                        docs: [
                            "// AADL feature: GNC_POS : requires data access POS.Impl",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "cpu_id",
                        ty: Named(
                            "isize",
                        ),
                        docs: [
                            "// 结构体新增 CPU ID",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "dispatch_protocol",
                        ty: Named(
                            "String",
                        ),
                        docs: [
                            "// AADL属性(impl): Dispatch_Protocol",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "period",
                        ty: Named(
                            "u64",
                        ),
                        docs: [
                            "// AADL属性(impl): Period",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "deadline",
                        ty: Named(
                            "u64",
                        ),
                        docs: [
                            "// AADL属性(impl): Deadline",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "priority",
                        ty: Named(
                            "u64",
                        ),
                        docs: [
                            "// AADL属性(impl): Priority",
                        ],
                        attrs: [],
                    },
                ],
                properties: [],
                generics: [],
                derives: [
                    "Debug",
                ],
                docs: [
                    "// AADL Thread: gnc_thread",
                ],
                vis: Public,
            },
        ),
        Impl(
            ImplBlock {
                target: Named(
                    "gnc_threadThread",
                ),
                generics: [],
                items: [
                    Method(
                        FunctionDef {
                            name: "new",
                            params: [
                                Param {
                                    name: "cpu_id",
                                    ty: Named(
                                        "isize",
                                    ),
                                },
                                Param {
                                    name: "gnc_pos",
                                    ty: Named(
                                        "POSShared",
                                    ),
                                },
                            ],
                            return_type: Named(
                                "Self",
                            ),
                            body: Block {
                                stmts: [
                                    Expr(
                                        Ident(
                                            "return Self {\n            deadline: 1000, \n            priority: 50, \n            gnc_pos: gnc_pos, \n            period: 1000, \n            dispatch_protocol: \"Periodic\".to_string(), \n            cpu_id: cpu_id, // CPU ID\n        }",
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: None,
                            docs: [
                                "// 创建组件并初始化AADL属性",
                            ],
                            attrs: [],
                        },
                    ),
                    Method(
                        FunctionDef {
                            name: "run",
                            params: [
                                Param {
                                    name: "",
                                    ty: Reference(
                                        Named(
                                            "self",
                                        ),
                                        false,
                                        true,
                                    ),
                                },
                            ],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Unsafe(
                                            Block {
                                                stmts: [
                                                    Let(
                                                        LetStmt {
                                                            ifmut: true,
                                                            name: "param",
                                                            ty: Some(
                                                                Named(
                                                                    "sched_param",
                                                                ),
                                                            ),
                                                            init: Some(
                                                                Ident(
                                                                    "sched_param { sched_priority: 50 }",
                                                                ),
                                                            ),
                                                        },
                                                    ),
                                                    Let(
                                                        LetStmt {
                                                            ifmut: false,
                                                            name: "ret",
                                                            ty: None,
                                                            init: Some(
                                                                Call(
                                                                    Path(
                                                                        [
                                                                            "pthread_setschedparam",
                                                                        ],
                                                                        Namespace,
                                                                    ),
                                                                    [
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "pthread_self",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [],
                                                                        ),
                                                                        MethodCall(
                                                                            MethodCall(
                                                                                Path(
                                                                                    [
                                                                                        "*CPU_ID_TO_SCHED_POLICY",
                                                                                    ],
                                                                                    Namespace,
                                                                                ),
                                                                                "get",
                                                                                [
                                                                                    Reference(
                                                                                        Path(
                                                                                            [
                                                                                                "self",
                                                                                                "cpu_id",
                                                                                            ],
                                                                                            Member,
                                                                                        ),
                                                                                        true,
                                                                                        false,
                                                                                    ),
                                                                                ],
                                                                            ),
                                                                            "unwrap_or",
                                                                            [
                                                                                Reference(
                                                                                    Path(
                                                                                        [
                                                                                            "SCHED_FIFO",
                                                                                        ],
                                                                                        Namespace,
                                                                                    ),
                                                                                    true,
                                                                                    false,
                                                                                ),
                                                                            ],
                                                                        ),
                                                                        Reference(
                                                                            Ident(
                                                                                "param",
                                                                            ),
                                                                            true,
                                                                            true,
                                                                        ),
                                                                    ],
                                                                ),
                                                            ),
                                                        },
                                                    ),
                                                    Expr(
                                                        If {
                                                            condition: BinaryOp(
                                                                Ident(
                                                                    "ret",
                                                                ),
                                                                "!=",
                                                                Literal(
                                                                    Int(
                                                                        0,
                                                                    ),
                                                                ),
                                                            ),
                                                            then_branch: Block {
                                                                stmts: [
                                                                    Expr(
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "eprintln!",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [
                                                                                Literal(
                                                                                    Str(
                                                                                        "gnc_threadThread: Failed to set thread priority: {}",
                                                                                    ),
                                                                                ),
                                                                                Ident(
                                                                                    "ret",
                                                                                ),
                                                                            ],
                                                                        ),
                                                                    ),
                                                                ],
                                                                expr: None,
                                                            },
                                                            else_branch: None,
                                                        },
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                    Expr(
                                        If {
                                            condition: BinaryOp(
                                                Path(
                                                    [
                                                        "self",
                                                        "cpu_id",
                                                    ],
                                                    Member,
                                                ),
                                                ">",
                                                Literal(
                                                    Int(
                                                        -1,
                                                    ),
                                                ),
                                            ),
                                            then_branch: Block {
                                                stmts: [
                                                    Expr(
                                                        Call(
                                                            Path(
                                                                [
                                                                    "set_thread_affinity",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [
                                                                Path(
                                                                    [
                                                                        "self",
                                                                        "cpu_id",
                                                                    ],
                                                                    Member,
                                                                ),
                                                            ],
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                            else_branch: None,
                                        },
                                    ),
                                    Let(
                                        LetStmt {
                                            ifmut: false,
                                            name: "period",
                                            ty: Some(
                                                Path(
                                                    [
                                                        "std",
                                                        "time",
                                                        "Duration",
                                                    ],
                                                ),
                                            ),
                                            init: Some(
                                                Call(
                                                    Path(
                                                        [
                                                            "Duration",
                                                            "from_millis",
                                                        ],
                                                        Namespace,
                                                    ),
                                                    [
                                                        Literal(
                                                            Int(
                                                                1000,
                                                            ),
                                                        ),
                                                    ],
                                                ),
                                            ),
                                        },
                                    ),
                                    Let(
                                        LetStmt {
                                            ifmut: true,
                                            name: "next_release",
                                            ty: None,
                                            init: Some(
                                                BinaryOp(
                                                    Ident(
                                                        "Instant::now()",
                                                    ),
                                                    "+",
                                                    Ident(
                                                        "period",
                                                    ),
                                                ),
                                            ),
                                        },
                                    ),
                                    Expr(
                                        Loop(
                                            Block {
                                                stmts: [
                                                    Let(
                                                        LetStmt {
                                                            ifmut: false,
                                                            name: "now",
                                                            ty: None,
                                                            init: Some(
                                                                Call(
                                                                    Path(
                                                                        [
                                                                            "Instant",
                                                                            "now",
                                                                        ],
                                                                        Namespace,
                                                                    ),
                                                                    [],
                                                                ),
                                                            ),
                                                        },
                                                    ),
                                                    Expr(
                                                        If {
                                                            condition: BinaryOp(
                                                                Ident(
                                                                    "now",
                                                                ),
                                                                "<",
                                                                Ident(
                                                                    "next_release",
                                                                ),
                                                            ),
                                                            then_branch: Block {
                                                                stmts: [
                                                                    Expr(
                                                                        MethodCall(
                                                                            Path(
                                                                                [
                                                                                    "std",
                                                                                    "thread",
                                                                                    "sleep",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            "",
                                                                            [
                                                                                Ident(
                                                                                    "next_release - now",
                                                                                ),
                                                                            ],
                                                                        ),
                                                                    ),
                                                                ],
                                                                expr: None,
                                                            },
                                                            else_branch: None,
                                                        },
                                                    ),
                                                    Expr(
                                                        Block(
                                                            Block {
                                                                stmts: [
                                                                    Expr(
                                                                        Ident(
                                                                            "// --- 调用序列（等价 AADL 的 Wrapper）---\n                           // welcome() -> update_pos() -> gnc_work() -> read_pos() -> bye()",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// welcome",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "gnc_identity",
                                                                                    "execute",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [],
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// update_pos",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Block(
                                                                            Block {
                                                                                stmts: [
                                                                                    Expr(
                                                                                        Block(
                                                                                            Block {
                                                                                                stmts: [
                                                                                                    Expr(
                                                                                                        IfLet {
                                                                                                            pattern: "Ok(mut guard)",
                                                                                                            value: MethodCall(
                                                                                                                Path(
                                                                                                                    [
                                                                                                                        "self",
                                                                                                                        "gnc_pos",
                                                                                                                    ],
                                                                                                                    Member,
                                                                                                                ),
                                                                                                                "lock",
                                                                                                                [],
                                                                                                            ),
                                                                                                            then_branch: Block {
                                                                                                                stmts: [
                                                                                                                    Expr(
                                                                                                                        Call(
                                                                                                                            Path(
                                                                                                                                [
                                                                                                                                    "update",
                                                                                                                                    "call",
                                                                                                                                ],
                                                                                                                                Namespace,
                                                                                                                            ),
                                                                                                                            [
                                                                                                                                Reference(
                                                                                                                                    Ident(
                                                                                                                                        "guard",
                                                                                                                                    ),
                                                                                                                                    true,
                                                                                                                                    true,
                                                                                                                                ),
                                                                                                                            ],
                                                                                                                        ),
                                                                                                                    ),
                                                                                                                ],
                                                                                                                expr: None,
                                                                                                            },
                                                                                                            else_branch: None,
                                                                                                        },
                                                                                                    ),
                                                                                                ],
                                                                                                expr: None,
                                                                                            },
                                                                                        ),
                                                                                    ),
                                                                                ],
                                                                                expr: None,
                                                                            },
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// gnc_work",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "gnc_job",
                                                                                    "execute",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [],
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// read_pos",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Block(
                                                                            Block {
                                                                                stmts: [
                                                                                    Expr(
                                                                                        Block(
                                                                                            Block {
                                                                                                stmts: [
                                                                                                    Expr(
                                                                                                        IfLet {
                                                                                                            pattern: "Ok(mut guard)",
                                                                                                            value: MethodCall(
                                                                                                                Path(
                                                                                                                    [
                                                                                                                        "self",
                                                                                                                        "gnc_pos",
                                                                                                                    ],
                                                                                                                    Member,
                                                                                                                ),
                                                                                                                "lock",
                                                                                                                [],
                                                                                                            ),
                                                                                                            then_branch: Block {
                                                                                                                stmts: [
                                                                                                                    Expr(
                                                                                                                        Call(
                                                                                                                            Path(
                                                                                                                                [
                                                                                                                                    "read_pos",
                                                                                                                                    "call",
                                                                                                                                ],
                                                                                                                                Namespace,
                                                                                                                            ),
                                                                                                                            [
                                                                                                                                Reference(
                                                                                                                                    Ident(
                                                                                                                                        "guard",
                                                                                                                                    ),
                                                                                                                                    true,
                                                                                                                                    true,
                                                                                                                                ),
                                                                                                                            ],
                                                                                                                        ),
                                                                                                                    ),
                                                                                                                ],
                                                                                                                expr: None,
                                                                                                            },
                                                                                                            else_branch: None,
                                                                                                        },
                                                                                                    ),
                                                                                                ],
                                                                                                expr: None,
                                                                                            },
                                                                                        ),
                                                                                    ),
                                                                                ],
                                                                                expr: None,
                                                                            },
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// bye",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "gnc_identity",
                                                                                    "execute",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [],
                                                                        ),
                                                                    ),
                                                                ],
                                                                expr: None,
                                                            },
                                                        ),
                                                    ),
                                                    Expr(
                                                        BinaryOp(
                                                            Ident(
                                                                "next_release",
                                                            ),
                                                            "+=",
                                                            Ident(
                                                                "period",
                                                            ),
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: None,
                            docs: [
                                "// Thread execution entry point",
                                "// Period: Some(1000) ms",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                trait_impl: Some(
                    Named(
                        "Thread",
                    ),
                ),
            },
        ),
        Struct(
            StructDef {
                name: "tmtc_threadThread",
                fields: [
                    Field {
                        name: "tmtc_pos",
                        ty: Named(
                            "POSShared",
                        ),
                        docs: [
                            "// AADL feature: TMTC_POS : requires data access POS.Impl",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "cpu_id",
                        ty: Named(
                            "isize",
                        ),
                        docs: [
                            "// 结构体新增 CPU ID",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "dispatch_protocol",
                        ty: Named(
                            "String",
                        ),
                        docs: [
                            "// AADL属性(impl): Dispatch_Protocol",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "period",
                        ty: Named(
                            "u64",
                        ),
                        docs: [
                            "// AADL属性(impl): Period",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "deadline",
                        ty: Named(
                            "u64",
                        ),
                        docs: [
                            "// AADL属性(impl): Deadline",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "priority",
                        ty: Named(
                            "u64",
                        ),
                        docs: [
                            "// AADL属性(impl): Priority",
                        ],
                        attrs: [],
                    },
                ],
                properties: [],
                generics: [],
                derives: [
                    "Debug",
                ],
                docs: [
                    "// AADL Thread: tmtc_thread",
                ],
                vis: Public,
            },
        ),
        Impl(
            ImplBlock {
                target: Named(
                    "tmtc_threadThread",
                ),
                generics: [],
                items: [
                    Method(
                        FunctionDef {
                            name: "new",
                            params: [
                                Param {
                                    name: "cpu_id",
                                    ty: Named(
                                        "isize",
                                    ),
                                },
                                Param {
                                    name: "tmtc_pos",
                                    ty: Named(
                                        "POSShared",
                                    ),
                                },
                            ],
                            return_type: Named(
                                "Self",
                            ),
                            body: Block {
                                stmts: [
                                    Expr(
                                        Ident(
                                            "return Self {\n            deadline: 100, \n            priority: 20, \n            period: 100, \n            dispatch_protocol: \"Periodic\".to_string(), \n            tmtc_pos: tmtc_pos, \n            cpu_id: cpu_id, // CPU ID\n        }",
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: None,
                            docs: [
                                "// 创建组件并初始化AADL属性",
                            ],
                            attrs: [],
                        },
                    ),
                    Method(
                        FunctionDef {
                            name: "run",
                            params: [
                                Param {
                                    name: "",
                                    ty: Reference(
                                        Named(
                                            "self",
                                        ),
                                        false,
                                        true,
                                    ),
                                },
                            ],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Unsafe(
                                            Block {
                                                stmts: [
                                                    Let(
                                                        LetStmt {
                                                            ifmut: true,
                                                            name: "param",
                                                            ty: Some(
                                                                Named(
                                                                    "sched_param",
                                                                ),
                                                            ),
                                                            init: Some(
                                                                Ident(
                                                                    "sched_param { sched_priority: 20 }",
                                                                ),
                                                            ),
                                                        },
                                                    ),
                                                    Let(
                                                        LetStmt {
                                                            ifmut: false,
                                                            name: "ret",
                                                            ty: None,
                                                            init: Some(
                                                                Call(
                                                                    Path(
                                                                        [
                                                                            "pthread_setschedparam",
                                                                        ],
                                                                        Namespace,
                                                                    ),
                                                                    [
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "pthread_self",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [],
                                                                        ),
                                                                        MethodCall(
                                                                            MethodCall(
                                                                                Path(
                                                                                    [
                                                                                        "*CPU_ID_TO_SCHED_POLICY",
                                                                                    ],
                                                                                    Namespace,
                                                                                ),
                                                                                "get",
                                                                                [
                                                                                    Reference(
                                                                                        Path(
                                                                                            [
                                                                                                "self",
                                                                                                "cpu_id",
                                                                                            ],
                                                                                            Member,
                                                                                        ),
                                                                                        true,
                                                                                        false,
                                                                                    ),
                                                                                ],
                                                                            ),
                                                                            "unwrap_or",
                                                                            [
                                                                                Reference(
                                                                                    Path(
                                                                                        [
                                                                                            "SCHED_FIFO",
                                                                                        ],
                                                                                        Namespace,
                                                                                    ),
                                                                                    true,
                                                                                    false,
                                                                                ),
                                                                            ],
                                                                        ),
                                                                        Reference(
                                                                            Ident(
                                                                                "param",
                                                                            ),
                                                                            true,
                                                                            true,
                                                                        ),
                                                                    ],
                                                                ),
                                                            ),
                                                        },
                                                    ),
                                                    Expr(
                                                        If {
                                                            condition: BinaryOp(
                                                                Ident(
                                                                    "ret",
                                                                ),
                                                                "!=",
                                                                Literal(
                                                                    Int(
                                                                        0,
                                                                    ),
                                                                ),
                                                            ),
                                                            then_branch: Block {
                                                                stmts: [
                                                                    Expr(
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "eprintln!",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [
                                                                                Literal(
                                                                                    Str(
                                                                                        "tmtc_threadThread: Failed to set thread priority: {}",
                                                                                    ),
                                                                                ),
                                                                                Ident(
                                                                                    "ret",
                                                                                ),
                                                                            ],
                                                                        ),
                                                                    ),
                                                                ],
                                                                expr: None,
                                                            },
                                                            else_branch: None,
                                                        },
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                    Expr(
                                        If {
                                            condition: BinaryOp(
                                                Path(
                                                    [
                                                        "self",
                                                        "cpu_id",
                                                    ],
                                                    Member,
                                                ),
                                                ">",
                                                Literal(
                                                    Int(
                                                        -1,
                                                    ),
                                                ),
                                            ),
                                            then_branch: Block {
                                                stmts: [
                                                    Expr(
                                                        Call(
                                                            Path(
                                                                [
                                                                    "set_thread_affinity",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [
                                                                Path(
                                                                    [
                                                                        "self",
                                                                        "cpu_id",
                                                                    ],
                                                                    Member,
                                                                ),
                                                            ],
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                            else_branch: None,
                                        },
                                    ),
                                    Let(
                                        LetStmt {
                                            ifmut: false,
                                            name: "period",
                                            ty: Some(
                                                Path(
                                                    [
                                                        "std",
                                                        "time",
                                                        "Duration",
                                                    ],
                                                ),
                                            ),
                                            init: Some(
                                                Call(
                                                    Path(
                                                        [
                                                            "Duration",
                                                            "from_millis",
                                                        ],
                                                        Namespace,
                                                    ),
                                                    [
                                                        Literal(
                                                            Int(
                                                                100,
                                                            ),
                                                        ),
                                                    ],
                                                ),
                                            ),
                                        },
                                    ),
                                    Let(
                                        LetStmt {
                                            ifmut: true,
                                            name: "next_release",
                                            ty: None,
                                            init: Some(
                                                BinaryOp(
                                                    Ident(
                                                        "Instant::now()",
                                                    ),
                                                    "+",
                                                    Ident(
                                                        "period",
                                                    ),
                                                ),
                                            ),
                                        },
                                    ),
                                    Expr(
                                        Loop(
                                            Block {
                                                stmts: [
                                                    Let(
                                                        LetStmt {
                                                            ifmut: false,
                                                            name: "now",
                                                            ty: None,
                                                            init: Some(
                                                                Call(
                                                                    Path(
                                                                        [
                                                                            "Instant",
                                                                            "now",
                                                                        ],
                                                                        Namespace,
                                                                    ),
                                                                    [],
                                                                ),
                                                            ),
                                                        },
                                                    ),
                                                    Expr(
                                                        If {
                                                            condition: BinaryOp(
                                                                Ident(
                                                                    "now",
                                                                ),
                                                                "<",
                                                                Ident(
                                                                    "next_release",
                                                                ),
                                                            ),
                                                            then_branch: Block {
                                                                stmts: [
                                                                    Expr(
                                                                        MethodCall(
                                                                            Path(
                                                                                [
                                                                                    "std",
                                                                                    "thread",
                                                                                    "sleep",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            "",
                                                                            [
                                                                                Ident(
                                                                                    "next_release - now",
                                                                                ),
                                                                            ],
                                                                        ),
                                                                    ),
                                                                ],
                                                                expr: None,
                                                            },
                                                            else_branch: None,
                                                        },
                                                    ),
                                                    Expr(
                                                        Block(
                                                            Block {
                                                                stmts: [
                                                                    Expr(
                                                                        Ident(
                                                                            "// --- 调用序列（等价 AADL 的 Wrapper）---\n                           // welcome() -> tmtc_work() -> update() -> bye()",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// welcome",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "tmtc_identity",
                                                                                    "execute",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [],
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// tmtc_work",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "tmtc_job",
                                                                                    "execute",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [],
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// update",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Block(
                                                                            Block {
                                                                                stmts: [
                                                                                    Expr(
                                                                                        Block(
                                                                                            Block {
                                                                                                stmts: [
                                                                                                    Expr(
                                                                                                        IfLet {
                                                                                                            pattern: "Ok(mut guard)",
                                                                                                            value: MethodCall(
                                                                                                                Path(
                                                                                                                    [
                                                                                                                        "self",
                                                                                                                        "tmtc_pos",
                                                                                                                    ],
                                                                                                                    Member,
                                                                                                                ),
                                                                                                                "lock",
                                                                                                                [],
                                                                                                            ),
                                                                                                            then_branch: Block {
                                                                                                                stmts: [
                                                                                                                    Expr(
                                                                                                                        Call(
                                                                                                                            Path(
                                                                                                                                [
                                                                                                                                    "update",
                                                                                                                                    "call",
                                                                                                                                ],
                                                                                                                                Namespace,
                                                                                                                            ),
                                                                                                                            [
                                                                                                                                Reference(
                                                                                                                                    Ident(
                                                                                                                                        "guard",
                                                                                                                                    ),
                                                                                                                                    true,
                                                                                                                                    true,
                                                                                                                                ),
                                                                                                                            ],
                                                                                                                        ),
                                                                                                                    ),
                                                                                                                ],
                                                                                                                expr: None,
                                                                                                            },
                                                                                                            else_branch: None,
                                                                                                        },
                                                                                                    ),
                                                                                                ],
                                                                                                expr: None,
                                                                                            },
                                                                                        ),
                                                                                    ),
                                                                                ],
                                                                                expr: None,
                                                                            },
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Ident(
                                                                            "// bye",
                                                                        ),
                                                                    ),
                                                                    Expr(
                                                                        Call(
                                                                            Path(
                                                                                [
                                                                                    "tmtc_identity",
                                                                                    "execute",
                                                                                ],
                                                                                Namespace,
                                                                            ),
                                                                            [],
                                                                        ),
                                                                    ),
                                                                ],
                                                                expr: None,
                                                            },
                                                        ),
                                                    ),
                                                    Expr(
                                                        BinaryOp(
                                                            Ident(
                                                                "next_release",
                                                            ),
                                                            "+=",
                                                            Ident(
                                                                "period",
                                                            ),
                                                        ),
                                                    ),
                                                ],
                                                expr: None,
                                            },
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: None,
                            docs: [
                                "// Thread execution entry point",
                                "// Period: Some(100) ms",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                trait_impl: Some(
                    Named(
                        "Thread",
                    ),
                ),
            },
        ),
        Struct(
            StructDef {
                name: "toy_example_procProcess",
                fields: [
                    Field {
                        name: "cpu_id",
                        ty: Named(
                            "isize",
                        ),
                        docs: [
                            "// 进程 CPU ID",
                        ],
                        attrs: [],
                    },
                    Field {
                        name: "gnc_th",
                        ty: Named(
                            "gnc_threadThread",
                        ),
                        docs: [
                            "// 子组件线程（GNC_Th : thread GNC_Thread）",
                        ],
                        attrs: [
                            Attribute {
                                name: "allow",
                                args: [
                                    Ident(
                                        "dead_code",
                                    ),
                                ],
                            },
                        ],
                    },
                    Field {
                        name: "tmtc_th",
                        ty: Named(
                            "tmtc_threadThread",
                        ),
                        docs: [
                            "// 子组件线程（TMTC_Th : thread TMTC_Thread）",
                        ],
                        attrs: [
                            Attribute {
                                name: "allow",
                                args: [
                                    Ident(
                                        "dead_code",
                                    ),
                                ],
                            },
                        ],
                    },
                    Field {
                        name: "pos_data",
                        ty: Named(
                            "POSShared",
                        ),
                        docs: [
                            "// 共享数据（POS_Data : data POS）",
                        ],
                        attrs: [
                            Attribute {
                                name: "allow",
                                args: [
                                    Ident(
                                        "dead_code",
                                    ),
                                ],
                            },
                        ],
                    },
                ],
                properties: [],
                generics: [],
                derives: [
                    "Debug",
                ],
                docs: [
                    "// AADL Process: toy_example_proc",
                ],
                vis: Public,
            },
        ),
        Impl(
            ImplBlock {
                target: Named(
                    "toy_example_procProcess",
                ),
                generics: [],
                items: [
                    Method(
                        FunctionDef {
                            name: "new",
                            params: [
                                Param {
                                    name: "cpu_id",
                                    ty: Named(
                                        "isize",
                                    ),
                                },
                            ],
                            return_type: Named(
                                "Self",
                            ),
                            body: Block {
                                stmts: [
                                    Let(
                                        LetStmt {
                                            ifmut: false,
                                            name: "pos_data",
                                            ty: Some(
                                                Named(
                                                    "POSShared",
                                                ),
                                            ),
                                            init: Some(
                                                Call(
                                                    Path(
                                                        [
                                                            "Arc",
                                                            "new",
                                                        ],
                                                        Namespace,
                                                    ),
                                                    [
                                                        Call(
                                                            Path(
                                                                [
                                                                    "Mutex",
                                                                    "new",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            [
                                                                Literal(
                                                                    Int(
                                                                        0,
                                                                    ),
                                                                ),
                                                            ],
                                                        ),
                                                    ],
                                                ),
                                            ),
                                        },
                                    ),
                                    Let(
                                        LetStmt {
                                            ifmut: false,
                                            name: "gnc_th",
                                            ty: Some(
                                                Named(
                                                    "gnc_threadThread",
                                                ),
                                            ),
                                            init: Some(
                                                Call(
                                                    Path(
                                                        [
                                                            "gnc_threadThread",
                                                            "new",
                                                        ],
                                                        Namespace,
                                                    ),
                                                    [
                                                        Ident(
                                                            "cpu_id",
                                                        ),
                                                        MethodCall(
                                                            Path(
                                                                [
                                                                    "Arc",
                                                                    "clone",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            "",
                                                            [
                                                                Reference(
                                                                    Ident(
                                                                        "pos_data",
                                                                    ),
                                                                    true,
                                                                    false,
                                                                ),
                                                            ],
                                                        ),
                                                    ],
                                                ),
                                            ),
                                        },
                                    ),
                                    Let(
                                        LetStmt {
                                            ifmut: false,
                                            name: "tmtc_th",
                                            ty: Some(
                                                Named(
                                                    "tmtc_threadThread",
                                                ),
                                            ),
                                            init: Some(
                                                Call(
                                                    Path(
                                                        [
                                                            "tmtc_threadThread",
                                                            "new",
                                                        ],
                                                        Namespace,
                                                    ),
                                                    [
                                                        Ident(
                                                            "cpu_id",
                                                        ),
                                                        MethodCall(
                                                            Path(
                                                                [
                                                                    "Arc",
                                                                    "clone",
                                                                ],
                                                                Namespace,
                                                            ),
                                                            "",
                                                            [
                                                                Reference(
                                                                    Ident(
                                                                        "pos_data",
                                                                    ),
                                                                    true,
                                                                    false,
                                                                ),
                                                            ],
                                                        ),
                                                    ],
                                                ),
                                            ),
                                        },
                                    ),
                                    Expr(
                                        Ident(
                                            "return Self { gnc_th, tmtc_th, pos_data, cpu_id }  //显式return",
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: None,
                            docs: [
                                "// Creates a new process instance",
                            ],
                            attrs: [],
                        },
                    ),
                    Method(
                        FunctionDef {
                            name: "start",
                            params: [
                                Param {
                                    name: "self",
                                    ty: Named(
                                        "Self",
                                    ),
                                },
                            ],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Let(
                                        LetStmt {
                                            ifmut: false,
                                            name: "Self { gnc_th, tmtc_th, pos_data, cpu_id, .. }",
                                            ty: None,
                                            init: Some(
                                                Ident(
                                                    "self",
                                                ),
                                            ),
                                        },
                                    ),
                                    Expr(
                                        MethodCall(
                                            BuilderChain(
                                                [
                                                    Named(
                                                        "\"gnc_th\".to_string()",
                                                    ),
                                                    Spawn {
                                                        closure: Closure(
                                                            [],
                                                            MethodCall(
                                                                Ident(
                                                                    "gnc_th",
                                                                ),
                                                                "run",
                                                                [],
                                                            ),
                                                        ),
                                                        move_kw: true,
                                                    },
                                                ],
                                            ),
                                            "unwrap",
                                            [],
                                        ),
                                    ),
                                    Expr(
                                        MethodCall(
                                            BuilderChain(
                                                [
                                                    Named(
                                                        "\"tmtc_th\".to_string()",
                                                    ),
                                                    Spawn {
                                                        closure: Closure(
                                                            [],
                                                            MethodCall(
                                                                Ident(
                                                                    "tmtc_th",
                                                                ),
                                                                "run",
                                                                [],
                                                            ),
                                                        ),
                                                        move_kw: true,
                                                    },
                                                ],
                                            ),
                                            "unwrap",
                                            [],
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: None,
                            docs: [
                                "// Starts all threads in the process",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                trait_impl: Some(
                    Named(
                        "Process",
                    ),
                ),
            },
        ),
        Struct(
            StructDef {
                name: "toy_exampleSystem",
                fields: [
                    Field {
                        name: "gnc_tmtc_pos",
                        ty: Named(
                            "toy_example_procProcess",
                        ),
                        docs: [
                            "// 子组件进程（GNC_TMTC_POS : process Toy_Example_Proc）",
                        ],
                        attrs: [
                            Attribute {
                                name: "allow",
                                args: [
                                    Ident(
                                        "dead_code",
                                    ),
                                ],
                            },
                        ],
                    },
                ],
                properties: [],
                generics: [],
                derives: [
                    "Debug",
                ],
                docs: [
                    "// AADL System: toy_example",
                ],
                vis: Public,
            },
        ),
        Impl(
            ImplBlock {
                target: Named(
                    "toy_exampleSystem",
                ),
                generics: [],
                items: [
                    Method(
                        FunctionDef {
                            name: "new",
                            params: [],
                            return_type: Named(
                                "Self",
                            ),
                            body: Block {
                                stmts: [
                                    Expr(
                                        Ident(
                                            "let mut gnc_tmtc_pos: toy_example_procProcess = toy_example_procProcess::new(0)",
                                        ),
                                    ),
                                    Expr(
                                        Ident(
                                            "return Self { gnc_tmtc_pos }  //显式return",
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: None,
                            docs: [
                                "// Creates a new system instance",
                            ],
                            attrs: [],
                        },
                    ),
                    Method(
                        FunctionDef {
                            name: "run",
                            params: [
                                Param {
                                    name: "self",
                                    ty: Named(
                                        "Self",
                                    ),
                                },
                            ],
                            return_type: Unit,
                            body: Block {
                                stmts: [
                                    Expr(
                                        Ident(
                                            "self.gnc_tmtc_pos.start()",
                                        ),
                                    ),
                                ],
                                expr: None,
                            },
                            asyncness: false,
                            vis: None,
                            docs: [
                                "// Runs the system, starts all processes",
                            ],
                            attrs: [],
                        },
                    ),
                ],
                trait_impl: Some(
                    Named(
                        "System",
                    ),
                ),
            },
        ),
        LazyStatic(
            LazyStaticDef {
                name: "CPU_ID_TO_SCHED_POLICY",
                ty: Generic(
                    "HashMap",
                    [
                        Named(
                            "isize",
                        ),
                        Named(
                            "i32",
                        ),
                    ],
                ),
                init: Block {
                    stmts: [
                        Let(
                            LetStmt {
                                ifmut: true,
                                name: "map",
                                ty: Some(
                                    Generic(
                                        "HashMap",
                                        [
                                            Named(
                                                "isize",
                                            ),
                                            Named(
                                                "i32",
                                            ),
                                        ],
                                    ),
                                ),
                                init: Some(
                                    Call(
                                        Path(
                                            [
                                                "HashMap",
                                                "new",
                                            ],
                                            Namespace,
                                        ),
                                        [],
                                    ),
                                ),
                            },
                        ),
                        Expr(
                            MethodCall(
                                Ident(
                                    "map",
                                ),
                                "insert",
                                [
                                    Literal(
                                        Int(
                                            0,
                                        ),
                                    ),
                                    Path(
                                        [
                                            "SCHED_FIFO",
                                        ],
                                        Namespace,
                                    ),
                                ],
                            ),
                        ),
                        Expr(
                            Ident(
                                "return map",
                            ),
                        ),
                    ],
                    expr: None,
                },
                vis: Public,
                docs: [
                    "// CPU ID到调度策略的映射",
                ],
            },
        ),
    ],
    attrs: [],
    vis: Public,
}