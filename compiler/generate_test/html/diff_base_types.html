<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<title>Diff for base_types</title>
<style>
body {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  background: #1e1e1e;
  color: #d4d4d4;
}
pre {
  white-space: pre-wrap;
}
.line-add    { background-color: #003800; color: #c8ffc8; }
.line-remove { background-color: #3f0001; color: #ffcccc; }
.line-header { color: #4fc1ff; font-weight: bold; }
</style>
</head>
<body>
<h2>Diff for base_types</h2>
<pre>
<span class="line-remove">--- original</span>
<span class="line-add">+++ modified</span>
<span class="line-header">@@ -1,5 +1,5 @@</span>
<span class="line-remove">-// 自动生成的 Rust 代码 - 来自 AADL 模型</span>
<span class="line-remove">-// 生成时间: 2025-12-08 19:26:09</span>
<span class="line-add">+// Auto-generated from AADL package: base_types</span>
<span class="line-add">+// 生成时间: 2025-12-20 17:31:23</span>

 #![allow(unused_imports)]
 use crossbeam_channel::{Receiver, Sender};
<span class="line-header">@@ -76,3 +76,24 @@</span>
 // AADL Data Type: String
 pub type String = String;

<span class="line-add">+// CPU ID到调度策略的映射</span>
<span class="line-add">+lazy_static! {</span>
<span class="line-add">+    static ref CPU_ID_TO_SCHED_POLICY: HashMap&lt;isize, i32&gt; = {</span>
<span class="line-add">+        let mut map: HashMap&lt;isize, i32&gt; = HashMap::new();</span>
<span class="line-add">+        map.insert(2, SCHED_FIFO);</span>
<span class="line-add">+        map.insert(1, SCHED_FIFO);</span>
<span class="line-add">+        map.insert(0, SCHED_FIFO);</span>
<span class="line-add">+        map.insert(3, SCHED_FIFO);</span>
<span class="line-add">+        return map;</span>
<span class="line-add">+    };</span>
<span class="line-add">+}</span>
<span class="line-add">+</span>
<span class="line-add">+// prio(P)=max(1,min(99,99−⌊k⋅log10(P)⌋))</span>
<span class="line-add">+// 根据周期计算优先级，周期越短优先级越高</span>
<span class="line-add">+// 用于 RMS (Rate Monotonic Scheduling) 和 DMS (Deadline Monotonic Scheduling)</span>
<span class="line-add">+pub fn period_to_priority(period_ms: f64) -&gt; i32 {</span>
<span class="line-add">+    let k: f64 = 10.0;</span>
<span class="line-add">+    let raw: f64 = 99.0 - k * period_ms.log10().floor();</span>
<span class="line-add">+    return raw.max(1.0).min(99.0) as i32;</span>
<span class="line-add">+}</span>
<span class="line-add">+</span>

</pre>
</body>
</html>
